@page "/{Country}/Authority/View/{Id}"

@using Clinical_Trials_Adverse_Events_Reporting_System.Entities
@using Clinical_Trials_Adverse_Events_Reporting_System.Data

@if (authority is null)
{
    <p><em>Loading...</em></p>
}
else
{
<form>
    <div class="form-group row">
        <label class="col-sm-2 col-form-label">Country</label>
        <div class="col-sm-10">
            <input type="text" class="form-control" @bind="authority.Country.Name" readonly />
        </div>
    </div>

    <div class="form-group row">
        <label class="col-sm-2 col-form-label">Institution</label>
        <div class="col-sm-10">
            <input type="text" class="form-control" @bind="authority.Institution.Name" readonly />
        </div>
    </div>

    <div class="form-group row">
        <label class="col-sm-2 col-form-label">Institution Type</label>
        <div class="col-sm-10">
            <input type="text" class="form-control" @bind="authority.InstitutionType.Name" readonly />
        </div>
    </div>

    <div class="form-group row">
        <label class="col-sm-2 col-form-label">Investigational Product Type</label>
        <div class="col-sm-10">
            <input type="text" class="form-control" @bind="authority.InvestigationalProductType.Name" readonly />
        </div>
    </div>

    <div class="form-group row">
        <label class="col-sm-2 col-form-label">Author</label>
        <div class="col-sm-10">
            <input type="text" class="form-control" @bind="authority.Author" readonly />
        </div>
    </div>

    <div class="form-group row">
        <label class="col-sm-2 col-form-label">Editor</label>
        <div class="col-sm-10">
            <input type="text" class="form-control" @bind="authority.Editor" readonly />
        </div>
    </div>

    <div class="form-group row">
        <label class="col-sm-2 col-form-label">Created</label>
        <div class="col-sm-10">
            <input type="text" class="form-control" @bind="authority.Created" readonly />
        </div>
    </div>

    <div class="form-group row">
        <label class="col-sm-2 col-form-label">Modified</label>
        <div class="col-sm-10">
            <input type="text" class="form-control" @bind="authority.Modified" readonly />
        </div>
    </div>

    <div class="col-md-12 text-center">
        <button type="button" class="btn btn-danger btn-lg btn-block" @onclick="Cancel">Cancel</button>
    </div>
</form>
}

@code {
    [Parameter]
    public string Country { get; set; }
    [Parameter]
    public string Id { get; set; }
    [Inject]
    AuthorityRepository authorityRepository { get; set; }
    [Inject]
    NavigationManager NavigationManager { get; set; }

    public Authority authority { get; set; }

    protected override async Task OnInitializedAsync()
    {
        authority = await Task.Run(() => authorityRepository.GetById(Convert.ToInt32(Id)));
    }

    private void Cancel()
    {
        NavigationManager.NavigateTo($"{Country}/Authorities/Index");
    }
}
